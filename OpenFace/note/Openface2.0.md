## 卷积专家约束局部模型（Convolutional Experts Constrained Local Model，CE-CLM）
点分布模型（Point Distribution Model，PDM） + 补丁专家（Patch Experts）（CNN）

也是由openface作者在2016年提出

论文：Convolutional Experts Constrained Local Model for Facial Landmark Detection

### 点分布模型：
#### 构建PDM的步骤

- 数据收集：

    收集大量标注了面部特征点的图像数据。每张图像中，面部特征点的位置被精确标注，这些特征点包括眼睛、鼻子、嘴巴、眉毛等关键点。

- 对齐数据：

    将所有标注的特征点数据进行对齐处理，以消除由于人脸位置、尺度和旋转等因素引起的差异。常用的对齐方法包括Procrustes分析，它通过平移、缩放和旋转使所有形状数据尽可能重合。

- 主成分分析（PCA）：

    对对齐后的形状数据进行PCA，以提取主要形状变化模式。PCA通过计算形状数据的协方差矩阵，并找到其特征值和特征向量，这些特征向量构成了形状变化的主方向。
    通过选择较大的特征值对应的特征向量，可以构建一个低维的形状空间，这个空间能够捕捉大部分的形状变化信息。

- 模型参数化：

    使用PCA得到的特征向量和均值形状，可以将任何形状表示为均值形状加上特征向量的线性组合。这些线性组合的系数就是PDM的参数，它们决定了形状在主要变化模式上的偏移程度。

    在面部特征点检测中，PDM提供了一个形状约束机制。就是说输入一张图片，通过PDM可以大概定位眼睛、鼻子、嘴巴、眉毛等关键点的位置。以至于不会将眼睛识别成鼻子。

### 补丁专家

每个补丁专家是一个小型的卷积神经网络，用于建模单个面部特征点的局部外观变化。

补丁专家的输入是面部特征点周围的一个局部图像补丁，输出是该补丁属于该特征点的概率或响应值。

就是说在由PDM确认的关键点大概位置的情况下，将这个位置的周边部分像素点输入cnn，然后分类得到一个关键点分类概率。这是一个不断迭代收敛的过程。

## OpenFace2.0 的优化

- 1.在不明显减少补丁准确率的情况下，减少补丁cnn网络的参数：缩小层数、镜像视图（只存储一半图像）

- 2.PDM初始化优化：PDM会初始化一个约束形状（11个），通过设置阈值的方法减少初始化匹配次数，达到阈值（达到想要的效果）就终止匹配，然后选择最优的那一个

- 3.稀疏响应图：为每个面部特征点计算响应图，在稀疏网格上进行计算，每隔一个像素跳过一次，然后通过双线性插值将其映射回密集网格。

- 4.目标跟踪：在视频中跟踪特征点时，根据前一帧中的特征点检测来初始化CE-CLM模型。为了防止跟踪漂移，实现了一个简单的四层CNN网络，该网络会报告当前检测到的特征点是否导致跟踪失败。如果CNN验证模块报告跟踪失败，将使用MTCNN面部检测器重新初始化模型。

- 5.优化补丁专家计算和面部检测所需的矩阵乘法，使用了OpenBLAS。它允许针对特定CPU架构进行优化计算。